<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#E87722">
    <title>Benetrip - Destinos Recomendados</title>

    <!-- Favicons da Tripinha -->
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon/favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/images/favicon/favicon-96x96.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/images/favicon/web-app-manifest-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/images/favicon/web-app-manifest-512x512.png">
    <link rel="manifest" href="assets/images/favicon/site.webmanifest">
    <meta name="theme-color" content="#E87722">
    <!-- FIM DOS FAVICONS -->

        <!-- Vercel Analytics -->
    <script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<script defer src="/_vercel/insights/script.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&family=Montserrat:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/mobile-optimizations.css">
    <link rel="stylesheet" href="assets/css/destinos.css">
    <link rel="stylesheet" href="assets/css/image-credits.css">
    <link rel="stylesheet" href="assets/css/share-module.css">
    <style>
      /* Estilos para o sistema de abas */
      .aba-ativa {
        color: #E87722;
        border-bottom: 2px solid #E87722;
        font-weight: 600;
      }
      
      .aba-inativa {
        color: #6B7280;
        border-bottom: 2px solid transparent;
      }
      
      /* Modal surpresa com scroll livre */
      .modal-surpresa-container {
        padding: 1rem !important;
        overflow-y: auto !important;
        align-items: flex-start !important;
      }
      
      .modal-surpresa-content {
        max-height: none !important;
        overflow: visible !important;
        margin: 2rem auto !important;
        position: relative;
      }
      
      .conteudo-aba-surpresa {
        max-height: none !important;
        overflow: visible !important;
      }
      
      /* Garantir que o body permita scroll quando modal estiver aberto */
      body:has(.modal-surpresa-container) {
        overflow: auto !important;
      }
      
      /* Anima√ß√µes e transi√ß√µes */
      .transition-all {
        transition-property: all;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        transition-duration: 300ms;
      }
      
      .scale-95 {
        transform: scale(0.95);
      }
      
      .scale-100 {
        transform: scale(1);
      }
      
      .opacity-0 {
        opacity: 0;
      }
      
      /* Layout responsivo adaptativo */
      @media (min-width: 480px) {
        #destinos-alternativos .grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      
      @media (max-width: 479px) {
        #destinos-alternativos .grid {
          grid-template-columns: 1fr;
        }
        
        /* Em mobile, garantir ainda mais que o modal seja scroll√°vel */
        .modal-surpresa-container {
          align-items: flex-start !important;
          justify-content: center !important;
          padding: 0.5rem !important;
        }
        
        .modal-surpresa-content {
          margin: 1rem auto !important;
          width: calc(100% - 1rem) !important;
        }
      }

      /* ========== ESTILOS ESPEC√çFICOS PARA TIPOS DE VIAGEM ========== */
      
      /* Indicadores de tipo de viagem */
      .tipo-viagem-indicator {
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 10px;
        font-weight: bold;
        z-index: 15;
        display: flex;
        align-items: center;
        gap: 4px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      }
      
      .tipo-viagem-rodoviario {
        background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
        color: white;
      }
      
      .tipo-viagem-aereo {
        background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
        color: white;
      }
      
      /* Header adaptado para mostrar tipo de viagem */
      .header-tipo-viagem {
        background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%);
        padding: 8px 16px;
        border-radius: 8px;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }
      
      .header-rodoviario {
        background: linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%);
        border: 1px solid #BBF7D0;
      }
      
      .header-aereo {
        background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
        border: 1px solid #BFDBFE;
      }
      
      /* Anima√ß√µes para √≠cones */
      @keyframes bounce-bus {
        0%, 20%, 50%, 80%, 100% { transform: translateX(0); }
        40% { transform: translateX(-3px); }
        60% { transform: translateX(3px); }
      }
      
      @keyframes fly-plane {
        0% { transform: translateX(-3px) translateY(1px); }
        50% { transform: translateX(3px) translateY(-1px); }
        100% { transform: translateX(-3px) translateY(1px); }
      }
      
      .bus-icon { animation: bounce-bus 2s infinite; }
      .plane-icon { animation: fly-plane 3s ease-in-out infinite; }
    </style>
</head>
<body class="mobile-optimized">
    <!-- Barra de status estilo app -->
    <div class="native-status-bar"></div>
    
    <div class="container" style="max-width: 480px; margin: 0 auto; padding: 0 1rem;">
        <!-- Header com bot√£o de voltar e indicador de tipo de viagem -->
        <header class="app-header">
            <button id="btn-voltar" class="btn-voltar" aria-label="Voltar para a p√°gina anterior">
                <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5M12 19l-7-7 7-7"></path>
                </svg>
                <span class="sr-only">Voltar</span>
            </button>
            <h1 id="titulo-dinamico">Destinos Recomendados</h1>
        </header>

        <!-- Indicador do tipo de viagem (ser√° preenchido dinamicamente) -->
        <div id="header-tipo-viagem" class="header-tipo-viagem hidden" role="region" aria-label="Tipo de viagem">
            <span id="icone-tipo-viagem" class="text-lg" aria-hidden="true"></span>
            <span id="texto-tipo-viagem" class="font-medium text-sm"></span>
            <span id="badge-economia" class="badge-economia hidden" aria-label="Op√ß√£o econ√¥mica">
                üí∞ Econ√¥mico
            </span>
        </div>
    
        <!-- Conte√∫do principal -->
        <main id="destinos-container">
            <!-- Conte√∫do de carregamento inicial -->
            <div class="loading-container">
                <div style="text-align: center; padding: 2rem 0;">
                    <img id="loading-avatar" src="assets/images/tripinha/avatar-pensando.png" alt="Tripinha carregando" class="loading-avatar" style="width: 80px; height: 80px; margin: 0 auto;" />
                    <div id="loading-text" class="loading-text" style="margin: 1rem 0;">Farejando destinos incr√≠veis para voc√™...</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Progresso da busca de destinos"></div>
                    </div>
                    <!-- Mensagens de progresso espec√≠ficas por tipo -->
                    <div id="progresso-especifico" class="text-xs text-gray-500 mt-2" aria-live="polite"></div>
                </div>
            </div>
            
            <!-- Interface principal (hidden inicialmente) -->
            <div id="conteudo-recomendacoes" class="hidden">
                <!-- Mensagem da Tripinha adaptada -->
                <div id="mensagem-tripinha" aria-live="polite"></div>
                
                <!-- Destino em destaque -->
                <section aria-labelledby="titulo-destaque">
                    <h2 id="titulo-destaque" class="sr-only">Destino em destaque</h2>
                    <div id="destino-destaque" class="mt-4" role="region" aria-labelledby="titulo-destaque"></div>
                </section>
                
                <!-- Destinos alternativos -->
                <section aria-labelledby="titulo-alternativos">
                    <h2 id="titulo-alternativos" class="sr-only">Destinos alternativos</h2>
                    <div id="destinos-alternativos" class="mt-4" role="region" aria-labelledby="titulo-alternativos"></div>
                </section>
                
                <!-- Op√ß√£o surpresa -->
                <section aria-labelledby="titulo-surpresa">
                    <h2 id="titulo-surpresa" class="sr-only">Op√ß√£o de destino surpresa</h2>
                    <div id="opcao-surpresa" class="mt-4" role="region" aria-labelledby="titulo-surpresa"></div>
                </section>

                <!-- Informa√ß√µes adicionais por tipo de viagem -->
                <div id="info-adicional-tipo-viagem" class="mt-6 hidden">
                    <!-- Para viagens rodovi√°rias -->
                    <div id="info-rodoviario" class="info-rodoviario hidden">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h3 class="font-medium text-green-800 mb-2 flex items-center">
                                <span class="mr-2">üöå</span>
                                Dicas para Viagens de √înibus
                            </h3>
                            <ul class="text-sm text-green-700 space-y-1">
                                <li>‚Ä¢ Chegue ao terminal com 30 minutos de anteced√™ncia</li>
                                <li>‚Ä¢ Leve documento de identidade original</li>
                                <li>‚Ä¢ Mantenha-se hidratado durante a viagem</li>
                                <li>‚Ä¢ Leve entretenimento para viagens longas</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Para viagens a√©reas -->
                    <div id="info-aereo" class="info-aereo hidden">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h3 class="font-medium text-blue-800 mb-2 flex items-center">
                                <span class="mr-2">‚úàÔ∏è</span>
                                Dicas para Viagens A√©reas
                            </h3>
                            <ul class="text-sm text-blue-700 space-y-1">
                                <li>‚Ä¢ Chegue ao aeroporto com 2h de anteced√™ncia (voos nacionais)</li>
                                <li>‚Ä¢ Fa√ßa check-in online para agilizar o processo</li>
                                <li>‚Ä¢ Consulte as regras de bagagem da companhia a√©rea</li>
                                <li>‚Ä¢ Mantenha documentos de viagem sempre √† m√£o</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Mensagem de erro (hidden inicialmente) -->
            <div id="erro-recomendacoes" class="hidden bg-red-100 text-red-700 p-4 rounded-lg my-4 text-center">
                <p id="mensagem-erro" class="font-bold"></p>
                <button id="btn-tentar-novamente" class="mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors">
                    Tentar Novamente
                </button>
            </div>
            
            <!-- Elementos da vers√£o anterior -->
            <div id="swipe-hint" class="swipe-hint" style="display:none;">
                <div class="swipe-hint-arrow">‚Üê</div>
                <div class="swipe-hint-text">Deslize para explorar</div>
            </div>
            
            <!-- Fixed bottom bar para a√ß√µes principais -->
            <div id="bottom-actions" class="fixed-bottom-bar" style="display:none;">
                <button class="btn-secundario btn-voltar">Refazer Quiz</button>
                <button id="btn-principal-acao" class="btn-principal btn-avancar">Ver Op√ß√µes</button>
            </div>
        </main>

        <!-- Se√ß√£o de feedback do usu√°rio -->
        <section id="feedback-secao" class="mt-8 hidden" aria-labelledby="feedback-titulo">
            <h2 id="feedback-titulo" class="sr-only">Feedback sobre as recomenda√ß√µes</h2>
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <h3 class="font-medium mb-3 text-center">Como voc√™ avalia nossas recomenda√ß√µes?</h3>
                <div class="flex justify-center gap-2">
                    <button class="feedback-btn" data-rating="1" aria-label="Muito ruim">üòû</button>
                    <button class="feedback-btn" data-rating="2" aria-label="Ruim">üòê</button>
                    <button class="feedback-btn" data-rating="3" aria-label="Bom">üòä</button>
                    <button class="feedback-btn" data-rating="4" aria-label="Muito bom">üòç</button>
                    <button class="feedback-btn" data-rating="5" aria-label="Excelente">ü§©</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Toast notification container -->
    <div id="toast-container" aria-live="polite"></div>

    <!-- Loading overlay para transi√ß√µes entre tipos de viagem -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 text-center">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto mb-4"></div>
            <p class="text-gray-700">Adaptando recomenda√ß√µes...</p>
        </div>
    </div>

    <!-- Scripts em ordem espec√≠fica para garantir carregamento correto -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    <script src="assets/js/config.js"></script>
    <script>
        // Verificar e inicializar config
        if (window.BENETRIP_CONFIG) {
            try {
                window.BENETRIP_CONFIG.init();
                console.log("BENETRIP_CONFIG inicializado");
            } catch (error) {
                console.error("Erro ao inicializar BENETRIP_CONFIG:", error);
            }
        } else {
            console.warn("BENETRIP_CONFIG n√£o dispon√≠vel, criando stub b√°sico");
            window.BENETRIP_CONFIG = {
                credentials: {},
                initialized: true,
                isProduction: true,
                getApiUrl: function(endpoint) {
                    return `/.netlify/functions/${endpoint.replace('Recommend', '-recommend').replace('Search', '-search')}`;
                },
                init: function() { return this; }
            };
        }
    </script>
    <script src="assets/js/ai-service.js"></script>
    <script src="assets/js/image-display.js"></script>
    <script>
        // Garantir que o servi√ßo de AI esteja inicializado
        if (window.BENETRIP_AI) {
            if (!window.BENETRIP_AI.isInitialized()) {
                window.BENETRIP_AI.init();
            }
            console.log("BENETRIP_AI inicializado");
        } else {
            console.error("BENETRIP_AI n√£o dispon√≠vel!");
        }
    </script>
    <script src="assets/js/destinos.js"></script>
    <script src="assets/js/mobile-interactions.js"></script>
    <script src="assets/js/share-module.js"></script>

    <!-- Script adicional para configurar indicadores visuais -->
    <script>
        // Configurar indicadores visuais baseados no tipo de viagem
        document.addEventListener('DOMContentLoaded', function() {
            // Listener para mudan√ßas no tipo de viagem
            document.addEventListener('benetrip_tipo_viagem_detectado', function(evento) {
                const tipoViagem = evento.detail.tipo;
                const isRodoviario = tipoViagem === 'rodoviario';
                
                // Atualizar classe do body
                document.body.classList.remove('viagem-rodoviaria', 'viagem-aerea');
                document.body.classList.add(isRodoviario ? 'viagem-rodoviaria' : 'viagem-aerea');
                
                // Atualizar header
                const headerTipoViagem = document.getElementById('header-tipo-viagem');
                const iconeTipoViagem = document.getElementById('icone-tipo-viagem');
                const textoTipoViagem = document.getElementById('texto-tipo-viagem');
                const badgeEconomia = document.getElementById('badge-economia');
                const tituloDinamico = document.getElementById('titulo-dinamico');
                
                if (headerTipoViagem && iconeTipoViagem && textoTipoViagem) {
                    headerTipoViagem.classList.remove('hidden', 'header-rodoviario', 'header-aereo');
                    headerTipoViagem.classList.add(isRodoviario ? 'header-rodoviario' : 'header-aereo');
                    
                    if (isRodoviario) {
                        iconeTipoViagem.textContent = 'üöå';
                        iconeTipoViagem.className = 'text-lg bus-icon';
                        textoTipoViagem.textContent = 'Viagens de √înibus';
                        badgeEconomia.classList.remove('hidden');
                        tituloDinamico.textContent = 'Destinos de √înibus';
                    } else {
                        iconeTipoViagem.textContent = '‚úàÔ∏è';
                        iconeTipoViagem.className = 'text-lg plane-icon';
                        textoTipoViagem.textContent = 'Viagens A√©reas';
                        badgeEconomia.classList.add('hidden');
                        tituloDinamico.textContent = 'Destinos de Avi√£o';
                    }
                }
                
                // Mostrar informa√ß√µes espec√≠ficas do tipo
                const infoRodoviario = document.getElementById('info-rodoviario');
                const infoAereo = document.getElementById('info-aereo');
                const infoAdicional = document.getElementById('info-adicional-tipo-viagem');
                
                if (infoRodoviario && infoAereo && infoAdicional) {
                    infoRodoviario.classList.toggle('hidden', !isRodoviario);
                    infoAereo.classList.toggle('hidden', isRodoviario);
                    infoAdicional.classList.remove('hidden');
                }
                
                // Atualizar mensagens de progresso
                const progressoEspecifico = document.getElementById('progresso-especifico');
                if (progressoEspecifico) {
                    progressoEspecifico.textContent = isRodoviario 
                        ? 'Buscando rotas de √¥nibus pr√≥ximas...' 
                        : 'Consultando companhias a√©reas...';
                }
                
                // Atualizar avatar de loading
                const loadingAvatar = document.getElementById('loading-avatar');
                if (loadingAvatar) {
                    loadingAvatar.src = isRodoviario 
                        ? 'assets/images/tripinha/avatar-onibus.png' 
                        : 'assets/images/tripinha/avatar-aviao.png';
                    loadingAvatar.onerror = function() {
                        this.src = 'assets/images/tripinha/avatar-pensando.png';
                    };
                }
                
                console.log(`üé® Indicadores visuais configurados para ${tipoViagem.toUpperCase()}`);
            });
            
            // Configurar bot√µes de feedback
            document.querySelectorAll('.feedback-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const rating = this.dataset.rating;
                    console.log(`üëç Feedback recebido: ${rating}/5`);
                    
                    // Destacar bot√£o selecionado
                    document.querySelectorAll('.feedback-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Salvar feedback
                    localStorage.setItem('benetrip_feedback_destinos', rating);
                    
                    // Mostrar agradecimento
                    setTimeout(() => {
                        const feedbackSecao = document.getElementById('feedback-secao');
                        if (feedbackSecao) {
                            feedbackSecao.innerHTML = `
                                <div class="text-center p-4">
                                    <span class="text-2xl">üôè</span>
                                    <p class="text-sm text-gray-600 mt-2">Obrigado pelo seu feedback!</p>
                                </div>
                            `;
                        }
                    }, 1000);
                });
            });
        });
        
        // Estilo para bot√µes de feedback
        const feedbackStyle = document.createElement('style');
        feedbackStyle.textContent = `
            .feedback-btn {
                font-size: 24px;
                padding: 8px;
                border: 2px solid transparent;
                border-radius: 50%;
                background: none;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .feedback-btn:hover {
                background: rgba(232, 119, 34, 0.1);
                border-color: rgba(232, 119, 34, 0.3);
            }
            .feedback-btn.selected {
                background: rgba(232, 119, 34, 0.2);
                border-color: #E87722;
                transform: scale(1.1);
            }
            .badge-economia {
                background: linear-gradient(135deg, #FEF3C7 0%, #FBBF24 100%);
                color: #92400E;
                padding: 4px 8px;
                border-radius: 16px;
                font-size: 10px;
                font-weight: bold;
                display: inline-flex;
                align-items: center;
                gap: 4px;
                border: 1px solid #F59E0B;
            }
        `;
        document.head.appendChild(feedbackStyle);
    </script>
</body>
</html>
